# Enrichment Feature Improvements

## –ó–º—ñ–Ω–∏ –≤–∏–∫–æ–Ω–∞–Ω–æ: 2025-01-08

### üéØ –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:

#### 1. **–ü–æ–≤–Ω–∏–π Fallback –õ–∞–Ω—Ü—é–≥ –¥–ª—è Domain Resolution**
–¢–µ–ø–µ—Ä —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –∑–Ω–∞–π—Ç–∏ –¥–æ–º–µ–Ω –≤ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É:
1. ‚úÖ –ü—Ä—è–º–∏–π domain –∑ input
2. ‚úÖ –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è domain –∑ email (—è–∫—â–æ –Ω–µ gmail/yahoo/hotmail)
3. ‚úÖ –ü–æ—à—É–∫ –≤ web –∑–∞ –Ω–∞–∑–≤–æ—é –∫–æ–º–ø–∞–Ω—ñ—ó
4. ‚úÖ **–ù–û–í–ò–ô:** –ü–æ—à—É–∫ –≤ web –∑–∞ email –∞–¥—Ä–µ—Å–æ—é
5. ‚úÖ **–ù–û–í–ò–ô:** –ü–æ—à—É–∫ –≤ web –∑–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º

**–§–∞–π–ª:** `app/api/enrich/org/route.ts` (—Ä—è–¥–∫–∏ 212-242)

---

#### 2. **–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –ï–∫—Å—Ç—Ä–∞–∫—Ü—ñ—è –°–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –ú–µ—Ä–µ–∂**
- **LinkedIn confidence:** 0.8 ‚Üí **0.95**
- **Facebook confidence:** 0.8 ‚Üí **0.95**
- **–í–ò–ü–†–ê–í–õ–ï–ù–û:** –î–æ–¥–∞–Ω–æ –º–∞–ø–ø—ñ–Ω–≥ `linkedin_url` —Ç–∞ `facebook_url` –≤ –º–æ–¥–∞–ª—Ü—ñ
- –¢–µ–ø–µ—Ä —Å–æ—Ü –º–µ—Ä–µ–∂—ñ –º–æ–∂–Ω–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ UI

**–§–∞–π–ª–∏:** 
- `app/api/enrich/org/route.ts` (—Ä—è–¥–∫–∏ 349-350)
- `components/modals/OpenOrganizationModal.tsx` (—Ä—è–¥–∫–∏ 292-304)

---

#### 3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ö—Ä–∞—ó–Ω–∏ —á–µ—Ä–µ–∑ LLM**
- **–ù–û–í–ò–ô:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `detectCountryLLM` –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—Ä–∞—ó–Ω–∏
- –ê–Ω–∞–ª—ñ–∑—É—î —Ç–µ–∫—Å—Ç –∑ —É—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ (–¥–æ 50k —Å–∏–º–≤–æ–ª—ñ–≤)
- Confidence –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ LLM –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ: high=0.9, medium=0.7, low=0.5
- –î–æ–¥–∞–Ω–æ –º–∞–ø–ø—ñ–Ω–≥ –ø–æ–ª—è `country` –≤ –º–æ–¥–∞–ª—Ü—ñ

**–§–∞–π–ª–∏:**
- `app/api/enrich/org/route.ts` (—Ä—è–¥–∫–∏ 353-372)
- `components/modals/OpenOrganizationModal.tsx` (—Ä—è–¥–∫–∏ 306-312)

---

#### 4. **–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è Email**
–î–æ–¥–∞–Ω–æ blacklist –¥–ª—è:
- Placeholder –µ–º–µ–π–ª—ñ–≤: `example.com`, `test.com`, `yourcompany.com`
- System –µ–º–µ–π–ª—ñ–≤: `noreply@`, `no-reply@`, `donotreply@`, `bounce@`, `mailer-daemon@`
- Platform –µ–º–µ–π–ª—ñ–≤: `sentry.io`, `wixpress.com`, `godaddy.com`, `wordpress.com`

**–§–∞–π–ª:** `app/api/enrich/org/route.ts` (—Ä—è–¥–∫–∏ 157-180)

---

#### 5. **–ü—ñ–¥–≤–∏—â–µ–Ω—ñ Confidence –†—ñ–≤–Ω—ñ**

| –ü–æ–ª–µ | –°—Ç–∞—Ä–µ | –ù–æ–≤–µ | –£–º–æ–≤–∞ |
|------|-------|------|-------|
| **Email (preferred)** | 0.9 | **0.95** | info@, sales@, contact@, office@, hello@, support@, enquiry@, inquiry@ |
| **Email (corporate)** | 0.7 | **0.8** | –ë—É–¥—å-—è–∫–∏–π @domain |
| **Email (other)** | 0.4 | **0.5** | –ù–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏–π |
| **Phone (international)** | 0.6 | **0.85** | –ü–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ + |
| **Phone (local)** | 0.6 | **0.75** | –ë–µ–∑ + |
| **Name (JSON-LD)** | 0.7 | **0.9** | –ó structured data |
| **Name (OpenGraph)** | 0.7 | **0.8** | –ó OG meta tags |
| **Name (Title)** | 0.7 | **0.7** | –ó <title> |
| **LinkedIn** | 0.8 | **0.95** | - |
| **Facebook** | 0.8 | **0.95** | - |

**–§–∞–π–ª:** `app/api/enrich/org/route.ts` (—Ä—ñ–∑–Ω—ñ —Å–µ–∫—Ü—ñ—ó)

---

#### 6. **–ë—ñ–ª—å—à–µ –°—Ç–æ—Ä—ñ–Ω–æ–∫ –¥–ª—è –ü–∞—Ä—Å–∏–Ω–≥—É**
–î–æ–¥–∞–Ω–æ –º—É–ª—å—Ç–∏–º–æ–≤–Ω—ñ —à–ª—è—Ö–∏:
- –£–∫—Ä–∞—ó–Ω—Å—å–∫—ñ: `–ø—Ä–æ-–Ω–∞—Å`, `–∫–æ–Ω—Ç–∞–∫—Ç–∏`, `–∑–≤'—è–∑–æ–∫`, `ua/contact`, `ua/about`
- –†–æ—Å—ñ–π—Å—å–∫—ñ: `–æ-–Ω–∞—Å`, `–æ-–∫–æ–º–ø–∞–Ω–∏–∏`, `–∫–æ–Ω—Ç–∞–∫—Ç—ã`, `ru/contact`, `ru/about`
- –ê–Ω–≥–ª—ñ–π—Å—å–∫—ñ: `en/contact`, `en/about`, `en/about-us`

**–§–∞–π–ª:** `app/api/enrich/org/route.ts` (—Ä—è–¥–∫–∏ 269-276)

---

#### 7. **–ü–æ–∫—Ä–∞—â–µ–Ω—ñ HTTP Headers**
–î–æ–¥–∞–Ω–æ —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω—ñ browser headers –¥–ª—è –∫—Ä–∞—â–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ —Å–∞–π—Ç—ñ–≤:
- User-Agent: Chrome 120
- Accept-Language: en, uk, ru
- Accept-Encoding: gzip, deflate, br
- DNT, Connection, Upgrade-Insecure-Requests

**–§–∞–π–ª:** `app/api/enrich/org/route.ts` (—Ä—è–¥–∫–∏ 64-85)

---

#### 8. **–ü–æ–∫—Ä–∞—â–µ–Ω–∏–π Trace –¥–ª—è –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏**
- –î–æ–¥–∞–Ω–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ—Ç–∞–ø—É –ø–æ—à—É–∫—É
- –î–æ–¥–∞–Ω–æ `country: false` –≤ extracted fields
- –ö—Ä–∞—â—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –∫–æ–∂–Ω–æ–≥–æ –µ—Ç–∞–ø—É

**–§–∞–π–ª:** `app/api/enrich/org/route.ts` (—Ä—è–¥–∫–∏ 190-196, 218, 224, 230)

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –¢—ñ–ª—å–∫–∏ Email (–±–µ–∑ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É)
**Input:** `john@gmail.com`
**–û—á—ñ–∫—É—î—Ç—å—Å—è:**
1. Domain –Ω–µ –≤–∏—Ç—è–≥–Ω–µ—Ç—å—Å—è –∑ email (gmail excluded)
2. –ü–æ—à—É–∫ –≤ web –∑–∞ `"john@gmail.com"`
3. –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ —Å–∞–π—Ç ‚Üí –ø–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤
4. –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—Ä–∞—ó–Ω–∏ —á–µ—Ä–µ–∑ LLM

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –¢—ñ–ª—å–∫–∏ –¢–µ–ª–µ—Ñ–æ–Ω
**Input:** `+380991234567`
**–û—á—ñ–∫—É—î—Ç—å—Å—è:**
1. –ü–æ—à—É–∫ –≤ web –∑–∞ `"+380991234567"`
2. –ó–Ω–∞–π–¥–µ–Ω–∏–π —Å–∞–π—Ç ‚Üí –ø–∞—Ä—Å–∏–Ω–≥
3. –ö—Ä–∞—ó–Ω–∞ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º + LLM

### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –ù–∞–∑–≤–∞ + –ö—Ä–∞—ó–Ω–∞
**Input:** `name: "Fujifilm Ukraine", country: "Ukraine"`
**–û—á—ñ–∫—É—î—Ç—å—Å—è:**
1. –ü–æ—à—É–∫ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∫—Ä–∞—ó–Ω–∏ (—è–∫ –∑–∞–ø–∏—Ç–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º)
2. –ü–∞—Ä—Å–∏–Ω–≥ –∑–Ω–∞–π–¥–µ–Ω–æ–≥–æ —Å–∞–π—Ç—É
3. LLM –≤–∏–∑–Ω–∞—á–∏—Ç—å –∫—Ä–∞—ó–Ω—É –∑ –∫–æ–Ω—Ç–µ–Ω—Ç—É

### –°—Ü–µ–Ω–∞—Ä—ñ–π 4: –°–æ—Ü—ñ–∞–ª—å–Ω—ñ –ú–µ—Ä–µ–∂—ñ
**–û—á—ñ–∫—É—î—Ç—å—Å—è:**
- LinkedIn/Facebook –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –∑ confidence 0.95
- –ú–æ–∂–Ω–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ —á–µ–∫–±–æ–∫—Å–∏ –≤ UI
- –ó–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ –ø–æ–ª—è `linkedin_url`, `facebook_url`

---

## üìã Checklist –¥–ª—è –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏

- [ ] Email search fallback –ø—Ä–∞—Ü—é—î (gmail/yahoo ‚Üí web search)
- [ ] Phone search fallback –ø—Ä–∞—Ü—é—î (—è–∫—â–æ email –Ω–µ –¥–∞–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É)
- [ ] LinkedIn/Facebook –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ suggestions —ñ –º–æ–∂–Ω–∞ apply
- [ ] –ö—Ä–∞—ó–Ω–∞ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ LLM —ñ –º–æ–∂–Ω–∞ apply
- [ ] Confidence —Ä—ñ–≤–Ω—ñ –≤–∏—â—ñ –¥–ª—è —è–∫—ñ—Å–Ω—ñ—à–∏—Ö –¥–∞–Ω–∏—Ö
- [ ] –ú—É–ª—å—Ç–∏–º–æ–≤–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –ø–∞—Ä—Å—è—Ç—å—Å—è (—É–∫—Ä/—Ä—É—Å/–∞–Ω–≥–ª)
- [ ] –§—ñ–ª—å—Ç—Ä—É—é—Ç—å—Å—è —Å–ø–∞–º –µ–º–µ–π–ª–∏ (noreply@, example.com, —Ç–æ—â–æ)
- [ ] Trace –ø–æ–∫–∞–∑—É—î –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ–∂–µ–Ω –µ—Ç–∞–ø

---

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ –≤ `.env.local` –∞–±–æ Settings —î:
```env
GOOGLE_SEARCH_API_KEY=your_key
GOOGLE_CSE_ID=your_cx
OPENAI_API_KEY=your_openai_key
```

–ë–µ–∑ —Ü–∏—Ö –∫–ª—é—á—ñ–≤:
- Web search –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ (fallback –ø–æ email/phone –Ω–µ —Å–ø—Ä–∞—Ü—é—î)
- LLM –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—Ä–∞—ó–Ω–∏ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ

---

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

1. **–ü–æ—à—É–∫ –∑–∞ –∫—Ä–∞—ó–Ω–æ—é –≤–∏–º–∫–Ω–µ–Ω–æ** —è–∫ –∑–∞–ø–∏—Ç–∞–Ω–æ - —Ç–µ–ø–µ—Ä `searchByName(name, null)` –∑–∞–º—ñ—Å—Ç—å `searchByName(name, country)`
2. **Clear/Cancel buttons –Ω–µ –¥–æ–¥–∞–Ω–æ** - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—Ä–æ—Å—Ç–æ –Ω–µ —Å—Ç–∞–≤–∏—Ç—å —á–µ–∫–±–æ–∫—Å–∏
3. **Consistency –≤ –ø–∞—Ä—Å–∏–Ω–≥—É:**
   - Emails: blacklist + –ø—Ä—ñ–æ—Ä–∏—Ç–∏–∑–∞—Ü—ñ—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏—Ö
   - Phones: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞ labels > international > general
   - Socials: regex match –¥–ª—è company/school URLs
   - Country: LLM –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (–Ω–µ heuristics)


